/**
 * @author D053411
 * @copyright 2020 SAP SE
 * @license SEE LICENSE IN LICENSE
 * @module titlecase
 * @fileoverview
 *   Warn when headings increment with more than 1 level at a time.
 *
 * @example {"name": "ok.md"}
 *
 *   # Alpha
 *
 *   ## Bravo
 *
 * @example {"name": "not-ok.md", "label": "input"}
 *
 *   # Charlie
 *
 *   ### Delta
 *
 * @example {"name": "not-ok.md", "label": "output"}
 *
 *   3:1-3:10: Heading levels should increment by one level at a time
 */
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.frontmatterHeadingCaseRule = exports.CODE_FRONTMATTER_HEADING_CASE = void 0;
const rule = require("unified-lint-rule");
const visit = require("unist-util-visit");
const generated = require("unist-util-generated");
const YAML = require("yaml");
const title_case_1 = require("title-case");
const helpers_1 = require("../helpers");
const rule_heading_case_1 = require("./rule-heading-case");
exports.CODE_FRONTMATTER_HEADING_CASE = "remark-lint:frontmatter-heading-case";
exports.frontmatterHeadingCaseRule = rule(exports.CODE_FRONTMATTER_HEADING_CASE, function (tree, file) {
    visit(tree, "yaml", visitYaml);
    function visitYaml(node) {
        if (generated(node))
            return;
        const originalContent = `---\n${String(node.value)}\n---`;
        const yaml = YAML.parse(String(node.value));
        if (!yaml.title)
            return;
        const originalTitle = yaml.title;
        const fixedTitle = title_case_1.titleCase(yaml.title);
        yaml.title = fixedTitle;
        const fixedContent = `---\n${YAML.stringify(yaml)}---`;
        if (originalTitle !== fixedTitle)
            helpers_1.makeMessage(exports.CODE_FRONTMATTER_HEADING_CASE, originalContent, fixedContent, node, rule_heading_case_1.REASON_HEADING_CASE, file, rule_heading_case_1.SHORT_LINK_HEADING_CASE);
    }
});
//# sourceMappingURL=rule-frontmatter-heading-case.js.map